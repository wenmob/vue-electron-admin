webpackJsonp([4],{"/Wcl":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("TRXr"),o=void 0,r={data:function(){var e=this;return{form:{name:"",pname:""},ruleForm1:{id:null,mobile:"",password:"",name:"",rate:""},ruleForm2:{id:"",desc:"",occurAmount:""},rules1:{mobile:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{validator:function(t,a,l){if(!a&&0==e.addCase)return l(new Error("密码不能为空"));l()},trigger:"blur"}],name:[{required:!0,message:"请输入商户名称",trigger:"blur"}],rate:[{required:!0,message:"请输入费率",trigger:"blur"}]},rules2:{occurAmount:[{required:!0,message:"请输入金额",trigger:"blur"}]},tableData:[],pagination:{pageSize:10,page_sizes:[10,20,30,50],currentPage:1,totalPage:0},dialogVisible1:!1,dialogVisible2:!1,dialogVisible3:!1,detail:{},addCase:0,loading:!0}},beforeDestroy:function(){o=void 0},mounted:function(){(o=this).getTableDatas()},methods:{getTableDatas:function(){o.loading=!0,l.a.getMerchantDatas(o.pagination.currentPage,o.pagination.pageSize,o.form.name,o.form.pname).then(function(e){if(0==e.code){o.pagination.totalPage=e.data.total;var t=e.data.rows;t.forEach(function(e){2==e.status?e.value=!1:e.value=!0}),o.tableData=t}else o.$message({message:e.msg,type:"warning"});o.loading=!1}).catch(function(e){o.$message.error("发生错误")})},onSubmit:function(){o.pagination.currentPage=1,o.getTableDatas()},save:function(){o.addCase=0,o.dialogVisible2=!0},handleSizeChange:function(e){o.pagination.pageSize=e,o.pagination.currentPage=1,o.getTableDatas()},handleCurrentChange:function(e){e!=o.pagination.currentPage&&(o.pagination.currentPage=e,o.getTableDatas())},setting:function(e){console.log(e);var t=e.id,a=void 0;a=2==e.status?1:2,l.a.changeStatus(t,a).then(function(t){0==t.code&&(1==a?(e.statusStr="正常",e.status=1):(e.statusStr="禁止",e.status=2))})},handleSee:function(e){l.a.viewCompanyDetail(e.id).then(function(e){console.log(e),e.code&&(o.detail=e.data),o.dialogVisible1=!0})},handleRe:function(e){var t=this;this.$confirm("确定要重置秘钥吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.resetKeys(e.id).then(function(e){e.code?o.$message({message:"操作成功",type:"success"}):o.$message({message:e.msg,type:"warning"})}).catch(function(e){o.$message.error("出现了错误，请稍后重试")})}).catch(function(){t.$message({type:"info",message:"已取消重置"})})},handleAS:function(e){o.ruleForm2={id:e.id,occurAmount:"",desc:""},o.dialogVisible3=!0},handleModify:function(e){o.ruleForm1={id:e.id,mobile:e.mobile,password:"",name:e.name,rate:e.rate},o.addCase=1,o.dialogVisible2=!0},submitForm:function(e){this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;l.a.saveSubCompany(o.ruleForm1.id,o.ruleForm1.mobile,o.ruleForm1.password,o.ruleForm1.name,o.ruleForm1.rate).then(function(e){0==e.code?o.$message({message:"操作成功",type:"success",onClose:function(){o.resetForm("ruleForm1"),0==o.addCase?(o.pagination.currentPage=1,o.getTableDatas(),o.dialogVisible2=!1):(o.getTableDatas(),o.dialogVisible2=!1)}}):o.$message({message:e.msg,type:"warning"})}).catch(function(e){o.$message.error("出错了，请稍后尝试")})})},resetForm:function(e){this.$refs[e].resetFields()},submitForm2:function(e){this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;l.a.updateCompanyBalance(o.ruleForm2.id,o.ruleForm2.desc,o.ruleForm2.occurAmount).then(function(e){0==e.code?o.$message({message:"加减款操作成功",type:"success",onClose:function(){o.resetForm2("ruleForm2"),o.getTableDatas(),o.dialogVisible3=!1}}):o.$message({message:e.msg,type:"warning"})}).catch(function(e){o.$message.error("出错了，请稍后尝试")})})},resetForm2:function(e){this.$refs[e].resetFields()},dialogSave:function(e){o.resetForm("ruleForm1"),e()},dialogSave2:function(e){o.resetForm2("ruleForm2"),e()}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-main"},[a("el-form",{attrs:{inline:!0,model:e.form}},[a("el-form-item",{attrs:{label:"商户名称"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入商户名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级商户"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入上级商户"},model:{value:e.form.pname,callback:function(t){e.$set(e.form,"pname",t)},expression:"form.pname"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"计费编号",align:"center",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"商户名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"parentName",label:"上级商户",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rate",align:"center",label:"费率(%)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"balance",align:"center",label:"可用余额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"arrearsStr",align:"center",label:"运转状况"}}),e._v(" "),a("el-table-column",{attrs:{prop:"statusStr",align:"center",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",align:"center",label:"创建时间",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"是否禁用"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){e.setting(t.row)}},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleSee(t.row)}}},[e._v("查看")]),e._v(" "),a("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"small"},on:{click:function(a){e.handleModify(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",size:"small"},on:{click:function(a){e.handleRe(t.row)}}},[e._v("重置")]),e._v(" "),a("el-button",{staticStyle:{color:"#E6A23C"},attrs:{type:"text",size:"small"},on:{click:function(a){e.handleAS(t.row)}}},[e._v("加减")])]}}])})],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{"margin-top":"30px"},attrs:{align:"center"}},[a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":e.pagination.page_sizes,"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.totalPage},on:{"size-change":e.handleSizeChange,"current-change":function(t){e.handleCurrentChange(t)},"update:currentPage":function(t){e.$set(e.pagination,"currentPage",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:"查看详情",visible:e.dialogVisible1,"close-on-press-escape":"",width:"360px"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[a("p",{staticClass:"dp1"},[a("span",[e._v("计费编号：")]),a("span",[e._v(e._s(e.detail.id))])]),e._v(" "),a("p",{staticClass:"dp1"},[a("span",[e._v("商户名称：")]),a("span",[e._v(e._s(e.detail.name))])]),e._v(" "),a("p",{staticClass:"dp1"},[a("span",[e._v("费率：")]),a("span",[e._v(e._s(e.detail.rate))])]),e._v(" "),a("p",{staticClass:"dp1"},[a("span",[e._v("可用余额：")]),a("span",[e._v(e._s(e.detail.balance))])]),e._v(" "),a("p",{staticClass:"dp1"},[a("span",[e._v("运转状况：")]),a("span",[e._v(e._s(e.detail.arrearsStr))])]),e._v(" "),a("p",{staticClass:"dp1"},[a("span",[e._v("状态：")]),a("span",[e._v(e._s(e.detail.statusStr))])]),e._v(" "),a("p",{staticClass:"dp1"},[a("span",[e._v("秘钥：")]),a("span",[e._v(e._s(e.detail.privateKey))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})]),e._v(" "),a("el-dialog",{attrs:{title:0==e.addCase?"添加商户":"修改商户",visible:e.dialogVisible2,"close-on-press-escape":"","before-close":e.dialogSave,width:"360px"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[a("el-form",{ref:"ruleForm1",attrs:{model:e.ruleForm1,"status-icon":"",rules:e.rules1,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"账号",prop:"mobile"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入用户名",clearable:"","auto-complete":"off"},model:{value:e.ruleForm1.mobile,callback:function(t){e.$set(e.ruleForm1,"mobile",t)},expression:"ruleForm1.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:"","auto-complete":"off"},model:{value:e.ruleForm1.password,callback:function(t){e.$set(e.ruleForm1,"password",t)},expression:"ruleForm1.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商户名称",prop:"name"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入商户名称",clearable:"","auto-complete":"off"},model:{value:e.ruleForm1.name,callback:function(t){e.$set(e.ruleForm1,"name",t)},expression:"ruleForm1.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"费率",prop:"rate"}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{type:"text",placeholder:"请输入费率",onkeyup:"value=value.replace(/[^\\d{1,}\\.\\d{1,}|\\d{1,}]/g,'')",clearable:"","auto-complete":"off"},model:{value:e.ruleForm1.rate,callback:function(t){e.$set(e.ruleForm1,"rate",t)},expression:"ruleForm1.rate"}})],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-tag",{staticStyle:{"border-style":"none","font-size":"15px"},attrs:{type:"info"}},[e._v("%")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm1")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("ruleForm1")}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),e._v(" "),a("el-dialog",{attrs:{title:"加减款",visible:e.dialogVisible3,"close-on-press-escape":"","before-close":e.dialogSave2,width:"360px"},on:{"update:visible":function(t){e.dialogVisible3=t}}},[a("el-form",{ref:"ruleForm2",attrs:{model:e.ruleForm2,"status-icon":"",rules:e.rules2,"label-width":"80px"}},[a("el-form-item",{attrs:{label:""}},[a("el-tag",{attrs:{type:"danger"}},[e._v("注：负数代表减少，正数代表添加")])],1),e._v(" "),a("el-form-item",{attrs:{label:"加减款",prop:"occurAmount"}},[a("el-input",{attrs:{type:"number",placeholder:"请输入金额",clearable:"","auto-complete":"off"},model:{value:e.ruleForm2.occurAmount,callback:function(t){e.$set(e.ruleForm2,"occurAmount",t)},expression:"ruleForm2.occurAmount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",clearable:"","auto-complete":"off"},model:{value:e.ruleForm2.desc,callback:function(t){e.$set(e.ruleForm2,"desc",t)},expression:"ruleForm2.desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm2("ruleForm2")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm2("ruleForm2")}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)],1)},staticRenderFns:[]};var s=a("VU/8")(r,n,!1,function(e){a("kw2w")},null,null);t.default=s.exports},kw2w:function(e,t){}});
//# sourceMappingURL=4.0dbe21bfbc4f037ef8f8.js.map